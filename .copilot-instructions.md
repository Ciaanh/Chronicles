# Chronicles World of Warcraft Addon - Copilot Instructions

## Project Overview

Chronicles is a World of Warcraft addon that provides a simple timeline interface for exploring WoW's historical events. The addon is designed to help players understand the rich lore and chronology of the Warcraft universe through an intuitive UI.

## Project Architecture

### Core Principles

1. **Modular Design**: The addon is organized into logical modules (Core, UI, Custom, Locales)
2. **Event-Driven Architecture**: Uses centralized event management and state management
3. **Expansion-Based Organization**: Content is organized by WoW expansions for easy maintenance
4. **Localization Ready**: Full localization support with dedicated locale files
5. **Logging System**: Comprehensive logging for debugging and error tracking

### Directory Structure

```
Chronicles/
├── Chronicles.toc           # Addon metadata and interface version
├── Chronicles.xml           # Main include file defining load order
├── Chronicles.lua           # Main addon initialization
├── Constants.lua            # Global constants and defaults
├── Functions.lua            # Utility functions
├── Core/                    # Core systems
│   ├── EventManager.lua     # Event handling
│   ├── StateManager.lua     # State management
│   └── Data.lua             # Data management utilities
├── UI/                      # User interface components
│   ├── MainFrameUI.lua      # Main timeline interface
│   ├── Templates/           # Reusable UI templates
│   └── Settings/            # Configuration UI
├── Data/                    # Content and database
│   ├── DB/                  # Event database files
│   └── Locales/             # Custom localization
├── Locales/                 # Base localization files
└── Libs/                    # Third-party libraries
```

## Code Style Guidelines

### Lua Conventions

-   Use PascalCase for addon namespaces and major components
-   Use camelCase for function names and variables
-   Use UPPER_SNAKE_CASE for constants
-   Prefix global addon variables with "Chronicles"
-   Use descriptive function and variable names

### WoW Addon Specific

-   Always check for nil values before accessing WoW API functions
-   Use proper event registration and unregistration
-   Implement proper frame lifecycle management
-   Use saved variables appropriately (ChroniclesDB)

### Error Handling

-   Implement proper error checking for WoW API calls
-   Gracefully handle missing dependencies
-   Provide user-friendly error messages

## Development Guidelines

### Adding New Events

1. Events should be added to appropriate expansion files in `Custom/DB/`
2. Follow the established event data structure
3. Include proper categorization (expansion, faction, character involvement)
4. Add localization strings for new content

### UI Development

1. Use the existing template system for consistency
2. Follow WoW's UI conventions and accessibility guidelines

### Localization

1. All user-facing strings must be localized
2. Add new strings to `Locales/enUS.lua` first
3. Use the Chronicles localization system: `Chronicles.L["STRING_KEY"]`
4. Provide context comments for translators

### Database Management

1. The Chronicles DB content is maintained using an external tauri application Chronicles-tauri (https://github.com/Ciaanh/Chronicles-tauri)
2. Events are organized by expansion for maintainability
3. Use consistent data structures across all event entries
4. Include proper metadata (dates, factions, characters)
5. Maintain chronological ordering within expansions

### Database Organization

The Chronicles database is organized into multiple files:

## Technical Specifications

### Data Processing Flow

1. Raw database objects are loaded from DB files
2. Core.Data.CleanEvent() processes them into clean objects
3. Localization keys are resolved to display text
4. Chapter content is processed for display
5. Search indexing data is generated
6. Clean objects are used throughout the UI system

### Content Organization Notes

-   All text content uses localization keys rather than direct strings
-   Content is organized in a hierarchical chapter/page structure for rich storytelling
-   The `timeline` field groups related content across different data types
-   Cross-references between events, characters, and factions use numeric IDs
-   The `eventType` field categorizes events for filtering and display purposes

### State Management

Use the StateManager for persistent data:

```lua
Chronicles.StateManager:GetState("key")
Chronicles.StateManager:SetState("key", value)
```

## Maintenance Notes

### Version Updates

1. Update interface version in Chronicles.toc for new WoW patches
2. Review and update event data for accuracy

### Performance Considerations

1. Minimize memory usage during event loading
2. Use efficient data structures for large event sets
3. Implement lazy loading for UI components
4. Profile addon performance regularly

## Integration Guidelines

### RP Addon Integration

The addon has optional integration with roleplay addons:

-   totalRP3: Character profile integration
-   MyRolePlay: Character information display

When adding new integrations:

1. Make all integrations optional
2. Gracefully handle missing dependencies
3. Provide fallback functionality
4. Document integration benefits for users

This project represents a comprehensive timeline system for World of Warcraft lore, designed to be maintainable, extensible, and user-friendly while following WoW addon development best practices.

## UI Development

For detailed UI development guidelines, see `.copilot-instructions-ui.md`

## Code Development

For detailed UI development guidelines, see `.copilot-instructions-code.md`
